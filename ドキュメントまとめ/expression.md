# Verse の式について

- 式はコードの最小単位
- 評価したときに結果がある
- Verse のあらゆるものが式
- すべてを評価して値を得られる
  - つまり、評価に失敗したら値を得られない
  - 失敗制御に移る

例 1:

```Verse
if (MyNumber > 5):
  "Big!"
else:
  "Small!"
```

例 2:

```Verse
MyArray : []int = for(Number := NumberArray, Number < 5):
  Number
```

- `MyArray` には、`NumberArray` から `5` より小さい要素だけを抽出する式を評価したものが代入される
  - Javascript でいう `filter` メソッドと同じ機能

## Verse での式の種類

### リテラル式

- はコードにおける固定値(数値や文字など)
- リテラルに次の型がある
  - `logic`
  - `int`
  - `float`
  - `string`
  - `option`
  - `enum`
- **失敗する可能性はない**

### 関数呼び出し式

- 関数呼び出しは式
- 形式が 2 つある
  - `FunctionName()`
  - `FunctionName[]`
- 結果タイプは、関数シグネチャで定義される

- 関数呼び出しが `FunctionName[]` 形式であり、関数定義に `<decides>` 指定子がある場合のみ、**失敗する可能性がある**

### 比較式

- 次の比較演算子のいずれかを使用して、2 つの内容を比較
  - `<`
  - `>`
  - `<=`
  - `>=`
  - `<>`
  - `=`
- **失敗する可能性がある**

### 代入式

- 可変 の場所に値を格納する
  - 例: 定数を初期化
  - 例: 変数の値を変更
- **失敗する可能性はない**

### 数式演算式

- 次の演算子を使用して計算を実行
  - `+`
  - `-`
  - `*`
  - `/`
- これらすべての演算子にはポインタとともに使用できる代入バリアントもある
- 整数での除算の場合のみ**失敗する可能性ある**

### 決定式

- 成功および失敗時の決定フローをコントロールする
  - 以下の演算子を使用
    - `not`
    - `and`
    - `or`
- **失敗する可能性がある**

### クエリ式

- ロジックやオプション値が `true` かどうかをチェックする
  - 演算子 `?` を使用する
- **失敗する可能性がある**

### クラスと構造体のインスタンス化式

- `class` や `struct` のインスタンスの作成
- **失敗する可能性はない**

### 制御フロー式

- コンピュータが命令を実行する順序
- `if` や `loop` などの式を使用して、フローを変更可能
- 一部の制御フロー式(`loop` など) は `void` のみを返すため、式を使用できるすべての場所で役に立つとは限らない
- 制御フロー式は以下
  - `if`
  - `case`
  - `for`
  - `loop`
  - `sync`
  - `race`
  - `rush`
  - `branch`
  - `spawn`
- **失敗する可能性はない**

### 配列式

- 同じ型の要素を格納できるコンテナ
- 配列の要素は配列に挿入した順番で配置される
- 各要素にはインデックスと呼ばれる配列内の位置に基づいてアクセスできる
- 配列でインデックス処理するときのみ**失敗する可能性がある**

### タプル式

- 複数の型の要素を格納できるコンテナ
- タプルの要素は、タプルに挿入した順番で配置される
- 各要素には、インデックスというタプル内の位置に基づいてアクセスできる
- **失敗する可能性はない**

### マップ式

- 別の値に関連付けた値(key/value ペア)を格納できるコンテナ
- key/value ペアは、key の型が比較可能な限り、任意の型を組み合わせることができる
- マップの要素はマップに key/value ペアを挿入した順になり、各要素には一意の key でアクセスできる
- **失敗する可能性はない**

### オプション式

- 値が 1 つまたは値がない型を含むコンテナ
- **失敗する可能性はない**

### 範囲式

- `..` を挟む 2 つの値
  - `1..5` など
- 最初から最後の数を**含む**
- `for` 式などの一部の場所でのみ使用可能
- **失敗する可能性はない**
